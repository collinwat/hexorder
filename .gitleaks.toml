# Gitleaks configuration â€” extends built-in rules with PII detection.
# https://github.com/gitleaks/gitleaks

[extend]
useDefault = true

[[rules]]
id = "email-address"
description = "Email address"
regex = '''[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}'''
tags = [ "pii" ]
[rules.allowlist]
regexTarget = "match"
regexes = [
  '''@example\.com''',
  '''@example\.org''',
  '''@users\.noreply\.github\.com''',
]

[[rules]]
id = "phone-number"
description = "Phone number (US/international)"
regex = '''(\+?1[\s\-.]?)?\(?\d{3}\)?[\s\-.]?\d{3}[\s\-.]?\d{4}'''
tags = [ "pii" ]

[[rules]]
id = "ssn"
description = "US Social Security Number"
regex = '''\b\d{3}[\-]\d{2}[\-]\d{4}\b'''
tags = [ "pii" ]

[[rules]]
id = "ip-address"
description = "IPv4 address"
regex = '''\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b'''
tags = [ "pii" ]
[rules.allowlist]
regexTarget = "match"
regexes = [
  '''127\.0\.0\.1''',
  '''0\.0\.0\.0''',
  '''192\.168\.\d{1,3}\.\d{1,3}''',
  '''10\.\d{1,3}\.\d{1,3}\.\d{1,3}''',
]

[allowlist]
paths = [ '''(?i)\.lock$''', '''(?i)target/''', '''(?i)\.git/''' ]
